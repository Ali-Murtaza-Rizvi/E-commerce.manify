<div class="payment-container">
  <!-- Stepper Form -->
  <div class="form-section">
    <mat-horizontal-stepper linear #stepper>
      <!-- Step 1: User Info -->
      <mat-step [stepControl]="userFormGroup">
        <form [formGroup]="userFormGroup">
          <ng-template matStepLabel>Basic Information</ng-template>
          <mat-form-field appearance="fill">
            <mat-label>Full Name</mat-label>
            <input matInput formControlName="fullName" required />
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Phone</mat-label>
            <input matInput formControlName="phone" required />
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" required />
          </mat-form-field>
          <button mat-raised-button color="primary" matStepperNext>Next</button>
        </form>
      </mat-step>

      <!-- Step 2: Address -->
      <mat-step [stepControl]="addressFormGroup">
        <form [formGroup]="addressFormGroup">
          <ng-template matStepLabel>Delivery Address</ng-template>
          <mat-form-field appearance="fill">
            <mat-label>Address</mat-label>
            <input matInput formControlName="address" required />
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>City</mat-label>
            <input matInput formControlName="city" required />
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>ZIP Code</mat-label>
            <input matInput formControlName="zip" required />
          </mat-form-field>
          <button mat-raised-button color="primary" matStepperPrevious>Back</button>
          <button mat-raised-button color="primary" matStepperNext>Next</button>
        </form>
      </mat-step>

      <!-- Step 3: Payment -->
      <mat-step [stepControl]="paymentFormGroup">
        <form [formGroup]="paymentFormGroup">
          <ng-template matStepLabel>Payment</ng-template>
          <mat-form-field appearance="fill">
            <mat-label>Payment Method</mat-label>
            <mat-select formControlName="method" required>
              <mat-option value="COD">Cash on Delivery</mat-option>
              <mat-option value="Card">Card</mat-option>
            </mat-select>
          </mat-form-field>

          <ng-container *ngIf="paymentFormGroup.get('method')?.value === 'Card'">
            <mat-form-field appearance="fill">
              <mat-label>Card Number</mat-label>
              <input matInput formControlName="cardNumber" />
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>Expiry</mat-label>
              <input matInput formControlName="expiry" />
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>CVV</mat-label>
              <input matInput formControlName="cvv" />
            </mat-form-field>
          </ng-container>

          <button mat-raised-button color="primary" matStepperPrevious>Back</button>
          <button mat-raised-button color="accent" (click)="placeOrder()">Place Order</button>
        </form>
      </mat-step>
    </mat-horizontal-stepper>
  </div>

  <!-- Order Summary -->
  <div class="summary-section">
    <h4>Order Summary</h4>
    <ul>
      <li *ngFor="let item of selectedItems">
        {{ item.name }} (x{{ item.quantity }}) — ₹{{ item.price * item.quantity }}
      </li>
    </ul>
    <hr />
    <p><strong>Total:</strong> ₹{{ totalPrice }}</p>
  </div>
</div>
